# Prompt Audit and Refactoring Complete

## Summary

Completed a comprehensive audit of all prompt files and refactored to centralize configuration.

## Audit Results

### 1. Inline Content References - FIXED

Found and removed all inline content references:

| File | Before | After |
|------|--------|-------|
| `jsonOutput.ts` | `--description="..."`, `--content="..."` | `--description-file=...`, `--content-file=...` |
| `nextSteps.ts` | `--message="<summary>"` | `--message-file="..."` |
| `generator.ts` | `--message="Phase 1..."` | `--message-file="$MSG_FILE"` |

### 2. Handoff Folder Path - CENTRALIZED

Created configuration files as single source of truth:

**Backend:** `services/backend/convex/prompts/config.ts`
**Webapp:** `apps/webapp/src/modules/chatroom/prompts/config.ts`

Both contain:
- `HANDOFF_DIR` constant (`".chatroom/tmp/handoff"`)
- `getHandoffFileSnippet()` helper for generating bash snippets
- `getMultiFileSnippet()` helper for multi-file operations

### 3. Files Updated

**Backend (10 files):**
- `config.ts` (new)
- `init/base.ts`
- `init/taskStarted.ts`
- `init/roles.ts`
- `taskDelivery/sections/backlogCommands.ts`
- `taskDelivery/sections/jsonOutput.ts`
- `taskDelivery/sections/nextSteps.ts`
- `generator.ts`
- Test snapshot updates

**Webapp (4 files):**
- `config.ts` (new)
- `init/base.ts`
- `init/task-started.ts`
- `init/roles.ts`

## Benefits

1. **Single source of truth** - Path is defined once in config
2. **No inline content** - All prompts use file-based input only
3. **DRY helpers** - `getHandoffFileSnippet()` reduces duplication
4. **Consistent patterns** - All prompts follow the same structure

## Release

- **Version:** 1.0.53
- **Published:** Yes to npm
- **Host CLI:** Updated to 1.0.53

## Git Commits

```
688f0ac chore(cli): bump version to 1.0.53
d82996d refactor(prompts): centralize handoff folder path in config
```
